{"ast":null,"code":"/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar DoubleLinkedNode =\n/** @class */\nfunction () {\n  function DoubleLinkedNode(keyVal) {\n    this.key = keyVal ? keyVal : '';\n    this.prevNode = null;\n    this.nextNode = null;\n  }\n\n  return DoubleLinkedNode;\n}();\n/**\n * double linked list plus a hash table inside\n * each key in the cache stored as a node in the list\n * recently visited node will be rotated to the head\n * so the Last Recently Visited node will be at the tail\n *\n * @member head - dummy head of the linked list\n * @member tail - dummy tail of the linked list\n * @member hashtable - the hashtable which maps cache key to list node\n * @member length - length of the list\n */\n\n\nvar CacheList =\n/** @class */\nfunction () {\n  /**\n   * initialization\n   */\n  function CacheList() {\n    this.head = new DoubleLinkedNode();\n    this.tail = new DoubleLinkedNode();\n    this.hashtable = {};\n    this.length = 0;\n    this.head.nextNode = this.tail;\n    this.tail.prevNode = this.head;\n  }\n  /**\n   * insert node to the head of the list\n   *\n   * @param node\n   */\n\n\n  CacheList.prototype.insertNodeToHead = function (node) {\n    var tmp = this.head.nextNode;\n    this.head.nextNode = node;\n    node.nextNode = tmp;\n    node.prevNode = this.head;\n    tmp.prevNode = node;\n    this.length = this.length + 1;\n  };\n  /**\n   * remove node\n   *\n   * @param node\n   */\n\n\n  CacheList.prototype.removeNode = function (node) {\n    node.prevNode.nextNode = node.nextNode;\n    node.nextNode.prevNode = node.prevNode;\n    node.prevNode = null;\n    node.nextNode = null;\n    this.length = this.length - 1;\n  };\n  /**\n   * @return true if list is empty\n   */\n\n\n  CacheList.prototype.isEmpty = function () {\n    return this.length === 0;\n  };\n  /**\n   * refresh node so it is rotated to the head\n   *\n   * @param key - key of the node\n   */\n\n\n  CacheList.prototype.refresh = function (key) {\n    var node = this.hashtable[key];\n    this.removeNode(node);\n    this.insertNodeToHead(node);\n  };\n  /**\n   * insert new node to the head and add it in the hashtable\n   *\n   * @param key - the key of the node\n   */\n\n\n  CacheList.prototype.insertItem = function (key) {\n    var node = new DoubleLinkedNode(key);\n    this.hashtable[key] = node;\n    this.insertNodeToHead(node);\n  };\n  /**\n   * @return the LAST Recently Visited key\n   */\n\n\n  CacheList.prototype.getLastItem = function () {\n    return this.tail.prevNode.key;\n  };\n  /**\n   * remove the cache key from the list and hashtable\n   * @param key - the key of the node\n   */\n\n\n  CacheList.prototype.removeItem = function (key) {\n    var removedItem = this.hashtable[key];\n    this.removeNode(removedItem);\n    delete this.hashtable[key];\n  };\n  /**\n   * @return length of the list\n   */\n\n\n  CacheList.prototype.getSize = function () {\n    return this.length;\n  };\n  /**\n   * @return true if the key is in the hashtable\n   * @param key\n   */\n\n\n  CacheList.prototype.containsKey = function (key) {\n    return key in this.hashtable;\n  };\n  /**\n   * clean up the list and hashtable\n   */\n\n\n  CacheList.prototype.clearList = function () {\n    for (var _i = 0, _a = Object.keys(this.hashtable); _i < _a.length; _i++) {\n      var key = _a[_i];\n\n      if (this.hashtable.hasOwnProperty(key)) {\n        delete this.hashtable[key];\n      }\n    }\n\n    this.head.nextNode = this.tail;\n    this.tail.prevNode = this.head;\n    this.length = 0;\n  };\n  /**\n   * @return all keys in the hashtable\n   */\n\n\n  CacheList.prototype.getKeys = function () {\n    return Object.keys(this.hashtable);\n  };\n  /**\n   * mainly for test\n   *\n   * @param key\n   * @return true if key is the head node\n   */\n\n\n  CacheList.prototype.isHeadNode = function (key) {\n    var node = this.hashtable[key];\n    return node.prevNode === this.head;\n  };\n  /**\n   * mainly for test\n   *\n   * @param key\n   * @return true if key is the tail node\n   */\n\n\n  CacheList.prototype.isTailNode = function (key) {\n    var node = this.hashtable[key];\n    return node.nextNode === this.tail;\n  };\n\n  return CacheList;\n}();\n\nexport default CacheList;","map":{"version":3,"mappings":"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","names":["keyVal","key","prevNode","nextNode","head","DoubleLinkedNode","tail","hashtable","length","CacheList","node","tmp","removeNode","insertNodeToHead","removedItem","keys","_i","hasOwnProperty","Object"],"sourceRoot":"","sources":["../../src/Utils/CacheList.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}